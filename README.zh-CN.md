# Gobi - ç°ä»£ Go åŸç”Ÿå•†ä¸šæ™ºèƒ½å¼•æ“

[English](./README.md)

ğŸš€ **ä¸€ä¸ªè½»é‡çº§ã€APIä¼˜å…ˆçš„å•†ä¸šæ™ºèƒ½å¼•æ“ï¼Œä½¿ç”¨ Go æ„å»º** - ä¸“ä¸ºéœ€è¦åµŒå…¥å¼åˆ†æã€è‡ªåŠ¨åŒ–æŠ¥å‘Šå’Œå®æ—¶æ•°æ®å¯è§†åŒ–çš„ç°ä»£åº”ç”¨ç¨‹åºè€Œè®¾è®¡ã€‚

## âœ¨ ä¸ºä»€ä¹ˆé€‰æ‹© Gobiï¼Ÿ

- **ğŸ”§ Go åŸç”Ÿ**: å®Œå…¨ä½¿ç”¨ Go æ„å»ºï¼Œæ€§èƒ½ä¼˜å¼‚ã€ç®€å•æ˜“ç”¨ã€éƒ¨ç½²ä¾¿æ·
- **ğŸ”Œ API ä¼˜å…ˆ**: æä¾› RESTful APIï¼Œæ”¯æŒ JWT å’Œ API Key è®¤è¯ï¼Œæ— ç¼é›†æˆ
- **ğŸ“Š å¤šå›¾è¡¨æ”¯æŒ**: ä»åŸºç¡€å›¾è¡¨åˆ°é«˜çº§ 3D å¯è§†åŒ–
- **ğŸ¤– è‡ªåŠ¨åŒ–å°±ç»ª**: æ”¯æŒå®šæ—¶æŠ¥å‘Šå’Œ Webhook é€šçŸ¥
- **ğŸ” ä¼ä¸šçº§å®‰å…¨**: å¤šç”¨æˆ·éš”ç¦»ã€API Key ç®¡ç†ã€Webhook ç­¾åéªŒè¯
- **ğŸ“ˆ ç”Ÿäº§å°±ç»ª**: æœåŠ¡å±‚æ¶æ„ã€å…¨é¢çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸ¯ å®Œç¾é€‚ç”¨äº

- **SaaS åº”ç”¨ç¨‹åº** éœ€è¦åµŒå…¥å¼åˆ†æåŠŸèƒ½
- **å¾®æœåŠ¡** éœ€è¦è½»é‡çº§ BI èƒ½åŠ›
- **å†…éƒ¨å·¥å…·** ç”¨äºæ•°æ®å¯è§†åŒ–å’ŒæŠ¥å‘Š
- **API ä¼˜å…ˆå¹³å°** éœ€è¦æ— å¤´ BI åŠŸèƒ½
- **Go åº”ç”¨ç¨‹åº** å¯»æ‰¾åŸç”Ÿ BI é›†æˆ

[![Go Version](https://img.shields.io/badge/Go-1.23-blue.svg)](https://go.dev/dl/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Build Status](https://github.com/sy-vendor/gobi/actions/workflows/go.yml/badge.svg)](https://github.com/sy-vendor/gobi/actions/workflows/go.yml)
[![Go Report Card](https://goreportcard.com/badge/github.com/sy-vendor/gobi)](https://goreportcard.com/report/github.com/sy-vendor/gobi)
[![GitHub stars](https://img.shields.io/github/stars/sy-vendor/gobi)](https://github.com/sy-vendor/gobi/stargazers)
[![API-First](https://img.shields.io/badge/API--First-Design-blueviolet)](https://github.com/sy-vendor/gobi)
[![3D Charts](https://img.shields.io/badge/3D--Charts-Supported-orange)](https://github.com/sy-vendor/gobi)

---

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

### ğŸ”Œ **API ä¼˜å…ˆæ¶æ„**
- æä¾›å…¨é¢çš„ CRUD æ“ä½œçš„ RESTful API
- **API Key è®¤è¯** ç”¨äºæœåŠ¡é—´é€šä¿¡
- **Webhook ç³»ç»Ÿ** å¸¦ç­¾åéªŒè¯çš„å®æ—¶é€šçŸ¥
- ç»Ÿä¸€çš„ JSON å“åº”æ ¼å¼å’Œé€‚å½“çš„é”™è¯¯å¤„ç†

### ğŸ“Š **é«˜çº§å¯è§†åŒ–**
- **12+ å›¾è¡¨ç±»å‹**: æŸ±çŠ¶å›¾ã€æŠ˜çº¿å›¾ã€é¥¼å›¾ã€æ•£ç‚¹å›¾ã€é›·è¾¾å›¾ã€çƒ­åŠ›å›¾ã€ä»ªè¡¨ç›˜ã€æ¼æ–—å›¾
- **3D å›¾è¡¨**: 3D æŸ±çŠ¶å›¾ã€3D æ•£ç‚¹å›¾ã€3D æ›²é¢å›¾ã€3D æ°”æ³¡å›¾
- äº¤äº’å¼å›¾è¡¨é…ç½®å’Œè‡ªå®šä¹‰
- Excel æ¨¡æ¿é›†æˆï¼Œç”Ÿæˆä¸“ä¸šæŠ¥å‘Š

### ğŸ¤– **è‡ªåŠ¨åŒ–å’Œè°ƒåº¦**
- **åŸºäº Cron çš„è°ƒåº¦** ç”¨äºè‡ªåŠ¨åŒ–æŠ¥å‘Šç”Ÿæˆ
- **Webhook é€šçŸ¥** ç”¨äºæŠ¥å‘Šå®Œæˆäº‹ä»¶
- **é‡è¯•é€»è¾‘** å¸¦æŒ‡æ•°é€€é¿çš„å¤±è´¥é‡è¯•
- **å‘é€è·Ÿè¸ª** å¸¦è¯¦ç»†æ—¥å¿—è®°å½•

### ğŸ” **ä¼ä¸šçº§å®‰å…¨**
- **JWT è®¤è¯** å¸¦å¯é…ç½®è¿‡æœŸæ—¶é—´
- **API Key ç®¡ç†** å¸¦å®‰å…¨ç”Ÿæˆå’ŒåŠé”€åŠŸèƒ½
- **å¤šç”¨æˆ·éš”ç¦»** ç¡®ä¿æ•°æ®éšç§
- **Webhook ç­¾åéªŒè¯** ç”¨äºå®‰å…¨é€šçŸ¥
- **åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶** (ç®¡ç†å‘˜/ç”¨æˆ·è§’è‰²)

### ğŸ—ï¸ **ç°ä»£æ¶æ„**
- **æœåŠ¡å±‚æ¨¡å¼** ç”¨äºæ¸…æ™°çš„å…³æ³¨ç‚¹åˆ†ç¦»
- **ä¾èµ–æ³¨å…¥** ç”¨äºæ”¹è¿›çš„å¯æµ‹è¯•æ€§
- **æ•°æ®åº“è¿æ¥æ± ** ç”¨äºæœ€ä½³æ€§èƒ½
- **å…¨é¢çš„é”™è¯¯å¤„ç†** å¸¦è¯¦ç»†æ—¥å¿—è®°å½•
- **é…ç½®ç®¡ç†** æ”¯æŒ YAML

### ğŸ“ˆ **æ•°æ®ç®¡ç†**
- **å¤šæ•°æ®åº“æ”¯æŒ** (SQLiteã€MySQLã€PostgreSQL)
- **SQL æŸ¥è¯¢ç®¡ç†** å¸¦æ‰§è¡Œè·Ÿè¸ª
- **æ•°æ®æºç®¡ç†** ç”¨äºé›†ä¸­è¿æ¥å¤„ç†
- **æŸ¥è¯¢ç¼“å­˜** ç”¨äºæ”¹è¿›æ€§èƒ½
- **ä»ªè¡¨ç›˜ç»Ÿè®¡** å’Œåˆ†æ

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### **åµŒå…¥å¼åˆ†æ**
```go
// å°† BI ç›´æ¥é›†æˆåˆ°æ‚¨çš„ Go åº”ç”¨ç¨‹åºä¸­
client := gobi.NewClient("https://your-gobi-instance.com")
client.SetAPIKey("your-api-key")

// ä»¥ç¼–ç¨‹æ–¹å¼åˆ›å»ºå›¾è¡¨
chart := &gobi.Chart{
    Name: "é”€å”®åˆ†æ",
    Type: "3d_surface",
    Data: salesData,
}
```

### **è‡ªåŠ¨åŒ–æŠ¥å‘Š**
```yaml
# ä½¿ç”¨ Webhook é€šçŸ¥è°ƒåº¦æ¯æ—¥æŠ¥å‘Š
schedule:
  name: "æ¯æ—¥é”€å”®æŠ¥å‘Š"
  cron: "0 9 * * *"  # æ¯å¤©ä¸Šåˆ 9 ç‚¹
  webhook: "https://your-app.com/webhooks/reports"
```

### **API ä¼˜å…ˆé›†æˆ**
```bash
# æœåŠ¡é—´è®¤è¯
curl -H "Authorization: ApiKey your-api-key" \
     https://gobi.example.com/api/charts

# å®æ—¶ Webhook é€šçŸ¥
POST /webhooks/reports
{
  "event": "report.generated",
  "data": { "report_id": 123, "status": "success" }
}
```

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Go 1.21+ ä¸ Gin æ¡†æ¶
- **æ•°æ®åº“**: SQLite (å¼€å‘) / MySQL/PostgreSQL (ç”Ÿäº§)
- **è®¤è¯**: JWT + API Keysï¼Œå¸¦ bcrypt å“ˆå¸Œ
- **å›¾è¡¨**: è‡ªå®šä¹‰ 3D æ¸²æŸ“ï¼Œæ”¯æŒ WebGL
- **è°ƒåº¦**: åŸºäº Cronï¼Œæ”¯æŒæ—¶åŒº
- **é€šçŸ¥**: Webhook ç³»ç»Ÿï¼Œå¸¦ HMAC ç­¾å
- **æ–‡æ¡£**: æ”¯æŒ OpenAPI/Swagger

---

## ğŸ“Š å›¾è¡¨å±•ç¤º

| å›¾è¡¨ç±»å‹ | 2D | 3D | äº¤äº’å¼ |
|------------|----|----|-------------|
| æŸ±çŠ¶å›¾ | âœ… | âœ… | âœ… |
| æŠ˜çº¿å›¾ | âœ… | âŒ | âœ… |
| é¥¼å›¾ | âœ… | âŒ | âœ… |
| æ•£ç‚¹å›¾ | âœ… | âœ… | âœ… |
| é¢ç§¯å›¾ | âœ… | âŒ | âœ… |
| æ›²é¢å›¾ | âŒ | âœ… | âœ… |
| çƒ­åŠ›å›¾ | âœ… | âŒ | âœ… |
| ä»ªè¡¨ç›˜ | âœ… | âŒ | âœ… |
| æ¼æ–—å›¾ | âœ… | âŒ | âœ… |
| çŸ©å½¢æ ‘çŠ¶å›¾ | âœ… | âŒ | âœ… |
| æ—­æ—¥å›¾ | âœ… | âŒ | âœ… |
| æ ‘å½¢å›¾ | âœ… | âŒ | âœ… |
| ç®±çº¿å›¾ | âœ… | âŒ | âœ… |
| Kçº¿å›¾ | âœ… | âŒ | âœ… |

---

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- Go 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- SQLiteï¼ˆç”¨äºå¼€å‘ï¼‰
- MySQL/PostgreSQLï¼ˆç”¨äºç”Ÿäº§ï¼‰

---

## âš¡ å¿«é€Ÿå¼€å§‹

```bash
# å…‹éš†å¹¶è¿è¡Œ
git clone https://github.com/sy-vendor/gobi.git
cd gobi
go mod download
go run cmd/server/main.go

# æœåŠ¡å™¨åœ¨ http://localhost:8080 å¯åŠ¨
# é»˜è®¤ç®¡ç†å‘˜: admin/admin123
```

---

## ğŸ“‹ é…ç½®

### é…ç½®æ–‡ä»¶

åº”ç”¨ç¨‹åºä½¿ç”¨ `config/config.yaml` è¿›è¡Œé…ç½®ç®¡ç†ã€‚

```yaml
default:
  server:
    port: "8080"
  jwt:
    secret: "default_jwt_secret"
    expiration_hours: 168
  database:
    type: "sqlite"
    dsn: "gobi.db"
```

### JWT é…ç½®

- `jwt.secret`: JWT ç­¾åå¯†é’¥
- `jwt.expiration_hours`: Token è¿‡æœŸæ—¶é—´ï¼ˆå°æ—¶ï¼‰
  - 168 = 7 å¤©
  - 720 = 30 å¤©
  - 2160 = 90 å¤©

---

## ğŸ”Œ API æ¥å£

### è®¤è¯
- `POST /api/auth/register` â€” æ³¨å†Œæ–°ç”¨æˆ·
- `POST /api/auth/login` â€” ç™»å½•å¹¶è·å– JWT ä»¤ç‰Œ

### API Key ç®¡ç†
- `POST /api/apikeys` â€” åˆ›å»ºæ–°çš„ API Key
- `GET /api/apikeys` â€” åˆ—å‡ºæ‰€æœ‰ API Keyï¼ˆç”¨æˆ·è‡ªå·±çš„æˆ–ç®¡ç†å‘˜å¯æŸ¥çœ‹æ‰€æœ‰ï¼‰
- `DELETE /api/apikeys/:id` â€” åŠé”€ API Key

### Webhook ç®¡ç†
- `POST /api/webhooks` â€” åˆ›å»ºæ–°çš„ Webhook
- `GET /api/webhooks` â€” åˆ—å‡ºæ‰€æœ‰ Webhookï¼ˆç”¨æˆ·è‡ªå·±çš„æˆ–ç®¡ç†å‘˜å¯æŸ¥çœ‹æ‰€æœ‰ï¼‰
- `GET /api/webhooks/:id` â€” è·å–ç‰¹å®š Webhook
- `PUT /api/webhooks/:id` â€” æ›´æ–° Webhook
- `DELETE /api/webhooks/:id` â€” åˆ é™¤ Webhook
- `GET /api/webhooks/:id/deliveries` â€” åˆ—å‡º Webhook å‘é€è®°å½•
- `POST /api/webhooks/:id/test` â€” æµ‹è¯• Webhook

### ä»ªè¡¨ç›˜
- `GET /api/dashboard/stats` â€” è·å–ä»ªè¡¨ç›˜ç»Ÿè®¡ä¿¡æ¯

### æ•°æ®æº
- `POST /api/datasources` â€” åˆ›å»ºæ–°æ•°æ®æº
- `GET /api/datasources` â€” åˆ—å‡ºæ‰€æœ‰æ•°æ®æº
- `GET /api/datasources/:id` â€” è·å–ç‰¹å®šæ•°æ®æº
- `PUT /api/datasources/:id` â€” æ›´æ–°æ•°æ®æº
- `DELETE /api/datasources/:id` â€” åˆ é™¤æ•°æ®æº

### æŸ¥è¯¢
- `POST /api/queries` â€” åˆ›å»ºæ–°æŸ¥è¯¢
- `GET /api/queries` â€” åˆ—å‡ºæ‰€æœ‰æŸ¥è¯¢
- `GET /api/queries/:id` â€” è·å–ç‰¹å®šæŸ¥è¯¢
- `PUT /api/queries/:id` â€” æ›´æ–°æŸ¥è¯¢
- `DELETE /api/queries/:id` â€” åˆ é™¤æŸ¥è¯¢
- `POST /api/queries/:id/execute` â€” æ‰§è¡ŒæŸ¥è¯¢

### å›¾è¡¨
- `POST /api/charts` â€” åˆ›å»ºæ–°å›¾è¡¨
- `GET /api/charts` â€” åˆ—å‡ºæ‰€æœ‰å›¾è¡¨
- `GET /api/charts/:id` â€” è·å–ç‰¹å®šå›¾è¡¨
- `PUT /api/charts/:id` â€” æ›´æ–°å›¾è¡¨
- `DELETE /api/charts/:id` â€” åˆ é™¤å›¾è¡¨

### Excel æ¨¡æ¿
- `POST /api/templates` â€” ä¸Šä¼ æ–°æ¨¡æ¿
- `GET /api/templates` â€” åˆ—å‡ºæ‰€æœ‰æ¨¡æ¿
- `GET /api/templates/:id/download` â€” ä¸‹è½½æ¨¡æ¿

### å®šæ—¶æŠ¥å‘Š
- `POST /api/reports/schedules` â€” åˆ›å»ºæ–°çš„å®šæ—¶æŠ¥å‘Š
- `GET /api/reports/schedules` â€” åˆ—å‡ºæ‰€æœ‰å®šæ—¶æŠ¥å‘Š
- `GET /api/reports/schedules/:id` â€” è·å–ç‰¹å®šå®šæ—¶æŠ¥å‘Š
- `PUT /api/reports/schedules/:id` â€” æ›´æ–°å®šæ—¶æŠ¥å‘Š
- `DELETE /api/reports/schedules/:id` â€” åˆ é™¤å®šæ—¶æŠ¥å‘Š

### æŠ¥å‘Š
- `GET /api/reports` â€” åˆ—å‡ºæ‰€æœ‰ç”Ÿæˆçš„æŠ¥å‘Š
- `GET /api/reports/:id/download` â€” ä¸‹è½½ç‰¹å®šæŠ¥å‘Š

---

## ğŸ“Š å›¾è¡¨ç±»å‹

æ”¯æŒçš„å›¾è¡¨ç±»å‹ï¼š
- æŸ±çŠ¶å›¾
- æŠ˜çº¿å›¾
- é¥¼å›¾
- æ•£ç‚¹å›¾
- é›·è¾¾å›¾
- çƒ­åŠ›å›¾
- ä»ªè¡¨ç›˜
- æ¼æ–—å›¾
- é¢ç§¯å›¾
- 3D æŸ±çŠ¶å›¾
- 3D æ•£ç‚¹å›¾
- 3D æ›²é¢å›¾
- 3D æ°”æ³¡å›¾
- çŸ©å½¢æ ‘çŠ¶å›¾ï¼ˆTreeMapï¼‰
- æ—­æ—¥å›¾
- æ ‘å½¢å›¾ï¼ˆTree Diagramï¼‰
- ç®±çº¿å›¾ï¼ˆBox Plotï¼‰
- Kçº¿å›¾/èœ¡çƒ›å›¾ï¼ˆCandlestickï¼‰

---

## ğŸ“Š å›¾è¡¨ç±»å‹è¯´æ˜

- çŸ©å½¢æ ‘çŠ¶å›¾ï¼ˆTreeMapï¼‰ï¼šç”¨åµŒå¥—çŸ©å½¢é¢ç§¯è¡¨è¾¾å±‚çº§å’Œæ•°å€¼ï¼Œé€‚åˆå æ¯”åˆ†æã€‚
- æ ‘å½¢å›¾ï¼ˆTree Diagramï¼‰ï¼šç”¨èŠ‚ç‚¹å’Œè¿çº¿è¡¨è¾¾å±‚çº§å…³ç³»ï¼Œé€‚åˆç»„ç»‡æ¶æ„ã€å®¶è°±ç­‰åˆ†æ”¯ç»“æ„ã€‚
- ç®±çº¿å›¾ï¼ˆBox Plotï¼‰ï¼šç”¨ç®±çº¿å›¾è¡¨ç¤ºæ•°æ®åˆ†å¸ƒå’Œäº”æ•°æ¦‚æ‹¬ï¼Œé€‚åˆæ•°æ®åˆ†æã€‚
- Kçº¿å›¾/èœ¡çƒ›å›¾ï¼ˆCandlestickï¼‰ï¼šç”¨äºè‚¡ç¥¨/é‡‘èæ•°æ®çš„å¯è§†åŒ–ã€‚

---

## â° Cron è¡¨è¾¾å¼æŒ‡å—

### åŸºæœ¬æ ¼å¼

```
* * * * *
â”‚ â”‚ â”‚ â”‚ â”‚
â”‚ â”‚ â”‚ â”‚ â””â”€â”€ æ˜ŸæœŸå‡  (0-7)
â”‚ â”‚ â”‚ â””â”€â”€â”€â”€ æœˆä»½ (1-12)
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€ æ—¥æœŸ (1-31)
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€ å°æ—¶ (0-23)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ†é’Ÿ (0-59)
```

### å¸¸è§ç¤ºä¾‹

- `0 9 * * *` â€” æ¯å¤©ä¸Šåˆ 9 ç‚¹
- `0 0 * * 1` â€” æ¯å‘¨ä¸€åˆå¤œ
- `35 16 * * *` â€” æ¯å¤©ä¸‹åˆ 4 ç‚¹ 35 åˆ†

---

## ğŸ”Œ API ä½¿ç”¨ç¤ºä¾‹

### ç™»å½•

```bash
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "admin123"
  }'
```

### åˆ›å»º API Key

```bash
curl -X POST http://localhost:8080/api/apikeys \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <your_jwt_token>" \
  -d '{
    "name": "æˆ‘çš„æœåŠ¡ API Key",
    "expires_at": "2024-12-31T23:59:59Z"
  }'
```

**å“åº”ï¼š**
```json
{
  "api_key": "abc123def456ghi789jkl012mno345pqr678stu901vwx234yz",
  "prefix": "abc123def456",
  "name": "æˆ‘çš„æœåŠ¡ API Key",
  "expires_at": "2024-12-31T23:59:59Z",
  "created_at": "2024-01-15T10:30:00Z"
}
```

### ä½¿ç”¨ API Key è®¤è¯
```bash
curl -X GET http://localhost:8080/api/queries \
  -H "Authorization: ApiKey abc123def456ghi789jkl012mno345pqr678stu901vwx234yz"
```

### åˆ—å‡º API Keys
```bash
curl -X GET http://localhost:8080/api/apikeys \
  -H "Authorization: Bearer <your_jwt_token>"
```

### åŠé”€ API Key
```bash
curl -X DELETE http://localhost:8080/api/apikeys/1 \
  -H "Authorization: Bearer <your_jwt_token>"
```

### åˆ›å»º Webhook
```bash
curl -X POST http://localhost:8080/api/webhooks \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <your_jwt_token>" \
  -d '{
    "name": "æŠ¥å‘Šé€šçŸ¥",
    "url": "https://your-app.com/webhooks/reports",
    "events": ["report.generated", "report.failed"],
    "headers": {
      "X-Custom-Header": "custom-value"
    }
  }'
```

### æµ‹è¯• Webhook
```bash
curl -X POST http://localhost:8080/api/webhooks/1/test \
  -H "Authorization: Bearer <your_jwt_token>"
```

### åˆ—å‡º Webhook å‘é€è®°å½•
```bash
curl -X GET http://localhost:8080/api/webhooks/1/deliveries \
  -H "Authorization: Bearer <your_jwt_token>"
```

### åˆ›å»ºå®šæ—¶æŠ¥å‘Š
```bash
curl -X POST http://localhost:8080/api/reports/schedules \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer <your_jwt_token>" \
  -d '{
    "name": "æ¯æ—¥é”€å”®æŠ¥å‘Š",
    "type": "daily",
    "query_ids": [1, 2, 3],
    "chart_ids": [1, 2],
    "template_ids": [1],
    "cron_pattern": "35 16 * * *"
  }'
```

---

## Webhook äº‹ä»¶

### æ”¯æŒçš„äº‹ä»¶

- `report.generated` â€” æŠ¥å‘Šç”ŸæˆæˆåŠŸ
- `report.failed` â€” æŠ¥å‘Šç”Ÿæˆå¤±è´¥
- `webhook.test` â€” Webhook æµ‹è¯•äº‹ä»¶

### äº‹ä»¶æ•°æ®æ ¼å¼

```json
{
  "event": "report.generated",
  "data": {
    "report_id": 123,
    "report_name": "æ¯æ—¥é”€å”®æŠ¥å‘Š",
    "schedule_id": 456,
    "schedule_name": "æ¯æ—¥é”€å”®è®¡åˆ’",
    "status": "success",
    "generated_at": "2024-01-15T10:30:00Z",
    "file_size": 1024,
    "download_url": "/api/reports/123/download"
  }
}
```

### Webhook å®‰å…¨

- **ç­¾åéªŒè¯**: æ¯ä¸ª webhook éƒ½åŒ…å« HMAC-SHA256 ç­¾å
- **è¯·æ±‚å¤´**: 
  - `X-Gobi-Signature`: HMAC ç­¾å
  - `X-Gobi-Timestamp`: Unix æ—¶é—´æˆ³
  - `X-Gobi-Event`: äº‹ä»¶ç±»å‹
- **é‡è¯•æœºåˆ¶**: è‡ªåŠ¨é‡è¯•ï¼ŒæŒ‡æ•°é€€é¿ï¼ˆ3æ¬¡å°è¯•ï¼‰
- **å‘é€è®°å½•**: æ‰€æœ‰å‘é€å°è¯•éƒ½ä¼šè¢«è®°å½•

### ç­¾åéªŒè¯

```python
import hmac
import hashlib

def verify_signature(payload, signature, timestamp, secret):
    message = f"{timestamp}.{payload}"
    expected = hmac.new(
        secret.encode('utf-8'),
        message.encode('utf-8'),
        hashlib.sha256
    ).hexdigest()
    return hmac.compare_digest(expected, signature)
```

---

## è®¤è¯æ–¹å¼

### JWT è®¤è¯
ä½¿ç”¨ `Authorization: Bearer <jwt_token>` å¤´éƒ¨è¿›è¡Œç”¨æˆ·è®¤è¯ã€‚

### API Key è®¤è¯
ä½¿ç”¨ `Authorization: ApiKey <api_key>` å¤´éƒ¨è¿›è¡ŒæœåŠ¡é—´è®¤è¯ã€‚

**API Key ç‰¹æ€§ï¼š**
- **å®‰å…¨ç”Ÿæˆ**ï¼š32å­—èŠ‚éšæœºå¯†é’¥ï¼Œä½¿ç”¨ bcrypt å“ˆå¸Œ
- **å‰ç¼€ç´¢å¼•**ï¼šä½¿ç”¨å¯†é’¥å‰ç¼€è¿›è¡Œå¿«é€ŸæŸ¥æ‰¾
- **è¿‡æœŸæ”¯æŒ**ï¼šå¯é€‰çš„è¿‡æœŸæ—¥æœŸ
- **åŠé”€åŠŸèƒ½**ï¼šå¯ä»¥åŠé”€å¯†é’¥è€Œä¸åˆ é™¤
- **ç”¨æˆ·éš”ç¦»**ï¼šç”¨æˆ·åªèƒ½ç®¡ç†è‡ªå·±çš„å¯†é’¥
- **ç®¡ç†å‘˜æƒé™**ï¼šç®¡ç†å‘˜å¯ä»¥ç®¡ç†æ‰€æœ‰å¯†é’¥

**å®‰å…¨æ³¨æ„äº‹é¡¹ï¼š**
- API Key ä»…åœ¨åˆ›å»ºæ—¶æ˜¾ç¤ºä¸€æ¬¡
- è¯·å®‰å…¨å­˜å‚¨å¯†é’¥ï¼Œåˆ‡å‹¿æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- ç”Ÿäº§ç¯å¢ƒè¯·ä½¿ç”¨ HTTPS ä¿æŠ¤å¯†é’¥ä¼ è¾“
- å®šæœŸè½®æ¢å¯†é’¥ä»¥å¢å¼ºå®‰å…¨æ€§

---

## é”™è¯¯å¤„ç†

æ‰€æœ‰ API é”™è¯¯å“åº”å‡ä¸º JSON æ ¼å¼ï¼š

```json
{
  "code": 401,
  "message": "Token expired",
  "error": "Token expired: token is expired"
}
```

### å¸¸è§Tokené”™è¯¯
- `Authorization header is required` - ç¼ºå°‘è®¤è¯å¤´
- `Invalid token` - Tokenæ— æ•ˆ
- `Token expired` - Tokenå·²è¿‡æœŸ
- `Token missing required claims` - Tokenç¼ºå°‘å¿…è¦ä¿¡æ¯
- `Invalid or expired API key` - API Key æ— æ•ˆæˆ–å·²è¿‡æœŸ

## å®‰å…¨ç‰¹æ€§

- æ‰€æœ‰æ¥å£éƒ½éœ€è¦ JWT è®¤è¯
- **API Key è®¤è¯ç”¨äºæœåŠ¡é—´é€šä¿¡**
- **Webhook ç­¾åéªŒè¯ç¡®ä¿é€šçŸ¥å®‰å…¨**
- ä½¿ç”¨ bcrypt åŠ å¯†å¯†ç 
- **API Key ä½¿ç”¨ bcrypt å“ˆå¸Œ**
- ç”¨æˆ·æ•°æ®éš”ç¦»
- **å®‰å…¨çš„éšæœºå¯†é’¥ç”Ÿæˆ**
- **è‡ªåŠ¨ Webhook é‡è¯•ï¼ŒæŒ‡æ•°é€€é¿** 